# 学习Git
>The entire Pro Git book, written by Scott Chacon and Ben Straub and published by Apress, is available here

## 1 起步
### 1.1 关于版本控制

**版本控制**是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的
系统。
你可以对任何类型的文件进行版本控制。
### 1.2 Git 基础
>请注意接下来的内容非常重要，若你理解了 `Git`的思想和基本工作原理,用起来就会
知其所以然，游刃有余。

#### 直接记录快照，而非差异比较
Git更像是把数据看作是对小型文件系统的一组快照。 每次你提交更新，或在 Git中
保存项目状态时，它主要对当时的全部文件制作一个快照并保存这个快照的索引。
为了高效，如果文件没有修改，Git不再重新存储该文件，而是只保留一个链接指向之前
存储的文件。 Git 对待数据更像是一个**快照流**。
#### 三种状态
如果你希望后面的学习更顺利，记住下面这些关于 Git 的概念。
Git 有三种状态，你的文件可能处于其中之一：
**已提交（committed）**、**已修改（modified)**和**已暂存（staged）**。
- 已提交表示数据已经安全的保存在本地数据库中。
- 已修改表示修改了文件，但还没保存到数据库中。
- 已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。

由此引入 Git 项目的三个工作区域的概念：**Git仓库、工作目录以及暂存区域**。
- Git 仓库目录是 Git 用来保存项目的元数据和对象数据库的地方。 这是 Git 中最
重要的部分，从其它计算机克隆仓库时，拷贝的就是这里的数据。
- 工作目录是对项目的某个版本独立提取出来的内容。 这些从 Git 仓库的压缩数据库
中提取出来的文件，放在磁盘上供你使用或修改。
- 暂存区域是一个文件，保存了下次将提交的文件列表信息，一般在 Git 仓库目录中。
 有时候也被称作`‘索引’'，不过一般说法还是叫暂存区域。

基本的 Git **工作流程**如下：
- 在工作目录中修改文件。
- 暂存文件，将文件的快照放入暂存区域。
- 提交更新，找到暂存区域的文件，将快照永久性存储到 Git 仓库目录。

如果 Git 目录中保存着的特定版本文件，就属于已提交状态。
如果作了修改并已放入暂存区域，就属于已暂存状态。 如果自上次取出后，作了修改但
还没有放到暂存区域，就是已修改状态。 在Git 基础一章，你会进一步了解这些状态的
细节，并学会如何根据文件状态实施后续操作，以及怎样跳过暂存直接提交。
## 1.3 安装 Git(windows)
使用anaconda的conda命令：
`conda install git`
## 1.4 初次运行 Git 前的配置
> 每台计算机上只需要配置一次，程序升级时会保留配置信息。 你可以在任何时候再次
通过运行命令来修改它们。

Git 自带一个 `git config `的工具来帮助设置控制 Git 外观和行为的配置变量。 这
些变量存储在三个不同的位置：
- /etc/gitconfig 文件: 包含系统上每一个用户及他们仓库的通用配置。 如果使用带
有 --system 选项的 git config 时，它会从此文件读写配置变量。
- ~/.gitconfig 或 ~/.config/git/config 文件：只针对当前用户。 可以传递 --global
选项让 Git 读写此文件。
- 当前使用仓库的 Git 目录中的 config 文件（就是 .git/config）：针对该仓库。
每一个级别覆盖上一级别的配置，所以 .git/config 的配置变量会覆盖 /etc/gitconfig 中
的配置变量。
在 Windows 系统中，Git 会查找 $HOME 目录下（一般情况下是 C:\Users\$USER）的 .gitconfig 文件。
Git 同样也会寻找 /etc/gitconfig 文件，但只限于 MSys 的根目录下，即安装 Git 时所选的目标位置。
### 用户信息
当安装完 Git 应该做的第一件事就是设置你的用户名称与邮件地址。
这样做很重要，因为每一个 Git 的提交都会使用这些信息，并且它会写入到你的每一次提交中，不可更改：
```
git config --global user.name "John Doe"
git config --global user.email johndoe@example.com
```
再次强调，如果使用了 `--global `选项，那么该命令只需要运行一次，因为之后无论你在该系统上做任何事情， Git 都会使用那些信息。 当你想针对特定项目使用不同的用户名称与邮件地址时，可以在那个项目目录下运行没有 --global 选项的命令来配置。
很多 GUI 工具都会在第一次运行时帮助你配置这些信息。
### 文本编辑器
既然用户信息已经设置完毕，你可以配置默认文本编辑器了，当 Git 需要你输入信息时会调用它。 如果未配置，Git 会使用操作系统默认的文本编辑器，通常是 Vim。 如果你想使用不同的文本编辑器，例如 Emacs，可以这样做：
`$ git config --global core.editor emacs`
### 检查配置信息
如果想要检查你的配置，可以使用 git config --list 命令来列出所有 Git 当时能找到的配置。

你可以通过输入 `git config <key>`： 来检查 Git 的某一项配置
```
git config user.name
John Doe
```
### 获取帮助
若你使用 Git 时需要获取帮助，有三种方法可以找到 Git 命令的使用手册：
- `$ git help <verb>`
- `$ git <verb> --help`
- `$ man git-<verb>`
例如，要想获得 config 命令的手册，执行
`$ git help config`
这些命令很棒，因为你随时随地可以使用而无需联网。 如果你觉得手册或者本书的内容还不够用，
你可以尝试在 Freenode IRC 服务器（ irc.freenode.net ）的` #git` 或 `#github` 频道寻求帮助。
这些频道经常有上百人在线，他们都精通 Git 并且乐于助人。
## 2 Git 基础
### 2.1 获取 Git 仓库
>假如你只能阅读一章来学习 Git，本章就是你的不二选择。 本章内容涵盖你在使用 Git 完成各种工作中将要使用的各种基本命令。 在学习完本章之后，你应该能够配置并初始化一个仓库（repository）、开始或停止跟踪（track）文件、暂存（stage）或提交（commit)更改。 本章也将向你演示如何配置 Git 来忽略指定的文件和文件模式、如何迅速而简单地撤销错误操作、如何浏览你的项目的历史版本以及不同提交（commits）间的差异、如何向你的远程仓库推送（push）以及如何从你的远程仓库拉取（pull）文件。

有两种取得 Git 项目仓库的方法。 第一种是在现有项目或目录下导入所有文件到 Git 中； 第二种是从一个服务器克隆一个现有的 Git 仓库。
>在现有目录中初始化仓库
>>如果你打算使用 Git 来对现有的项目进行管理，你只需要进入该项目目录并输入：`$ git init`
该命令将创建一个名为 .git 的子目录，这个子目录含有你初始化的 Git 仓库中所有的必须文件,
这些文件是 Git 仓库的骨干。 但是，在这个时候，我们仅仅是做了一个初始化的操作，你的项目里的
文件还没有被跟踪。 (参见 Git 内部原理 来了解更多关于到底 .git 文件夹中包含了哪些文件的信息。)
如果你是在一个已经存在文件的文件夹（而不是空文件夹）中初始化 Git 仓库来进行版本控制的
话，你应该开始跟踪这些文件并提交。 你可通过 git add 命令来实现对指定文件的跟踪，然后执行
 git commit 提交：
```
$ git add *.c
$ git add LICENSE
$ git commit -m 'initial project version'
```
稍后我们再逐一解释每一条指令的意思。 现在，你已经得到了一个实际维护（或者说是跟踪）着若干
个文件的 Git 仓库。

>克隆现有的仓库
如果你想获得一份已经存在了的 Git 仓库的拷贝，比如说，你想为某个开源项目贡献自己的一份力，这时就要用到`git clone`命令。
Git 克隆的是该 Git 仓库服务器上的几乎所有数据，而不是仅仅复制完成你的工作所需要文件。
当你执行`git clone`命令的时候，默认配置下远程 Git 仓库中的每一个文件的每一个版本都将被拉取下
来。 事实上，如果你的服务器的磁盘坏掉了，你通常可以使用任何一个克隆下来的用户端来重建服务器上
的仓库（虽然可能会丢失某些服务器端的挂钩设置，但是所有版本的数据仍在，详见 在服务器上搭建 Git ）。
克隆仓库的命令格式是 `git clone [url]` 。 比如，要克隆 Git 的可链接库 libgit2，可以用下面的命令：
```
$ git clone https://github.com/libgit2/libgit2
```
这会在当前目录下创建一个名为 “libgit2” 的目录，并在这个目录下初始化一个 .git 文件夹，从远程仓库拉取下所有数据放入 .git 文件夹，然后从中读取最新版本的文件的拷贝。 如果你进入到这个新建的 libgit2 文件夹，你会发现所有的项目文件已经在里面了，准备就绪等待后续的开发和使用。 如果你想在克隆远程仓库的时候，自定义本地仓库的名字，你可以使用如下命令：
```
$ git clone https://github.com/libgit2/libgit2 mylibgit
```
这将执行与上一个命令相同的操作，不过在本地创建的仓库名字变为 mylibgit。

### 2.2 记录每次更新到仓库
请记住，你工作目录下的每一个文件都不外乎这两种状态：已跟踪或未跟踪。 已跟踪的
文件是指那些被纳入了版本控制的文件，在上一次快照中有它们的记录，在工作一段时间
后，它们的状态可能处于未修改，已修改或已放入暂存区。
工作目录中除已跟踪文件以
外的所有其它文件都属于未跟踪文件，它们既不存在于上次快照的记录中，也没有放入
暂存区。 初次克隆某个仓库的时候，工作目录中的所有文件都属于已跟踪文件，并处于
未修改状态。
- 要查看哪些文件处于什么状态，可以用 `git status`命令。
- 使用命令 `git add 文件名或目录`开始跟踪一个文件。

- 状态简览：
git status 命令的输出十分详细，但其用语有些繁琐。 如果你使用`git status -s`
命令或 `git status --short`命令，你将得到一种更为紧凑的格式输出。
- **忽略文件**: 一般我们总会有些文件无需纳入 Git 的管理，也不希望它们
总出现在未跟踪文件列表。 通常都是些自动生成的文件，比如日志文件，或者编译过
程中创建的临时文件等。 在这种情况下，我们可以创建一个名为` .gitignore` 的文件，列出要忽略的文件模式。
>来看一个实际的例子：
```
$ cat .gitignore
*.[oa]
*~
```
第一行告诉 Git 忽略所有以 .o 或 .a 结尾的文件。一般这类对象文件和存档文件都是编译过程中出现的。 第二行告诉 Git 忽略所有以波浪符（~）结尾的文件，许多文本编辑软件（比如 Emacs）都用这样的文件名保存副本。 此外，你可能还需要忽略 log，tmp 或者 pid 目录，以及自动生成的文档等等。 要养成一开始就设置好 .gitignore 文件的习惯，以免将来误提交这类无用的文件。

文件` .gitignore `的格式规范如下：

- 所有空行或者以 `＃ `开头的行都会被 Git 忽略。
- 可以使用标准的 `glob` 模式匹配。
- 匹配模式可以以（/）开头防止递归。
- 匹配模式可以以（/）结尾指定目录。
- 要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号（!）取反。
- 所谓的` glob `模式是指 shell 所使用的简化了的正则表达式。
星号`（*）`匹配零个或多个任意字符；`[abc]` 匹配任何一个列在
方括号中的字符（这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）；
问号（?）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符，
表示所有在这两个字符范围内的都可以
匹配（比如 `[0-9]` 表示匹配所有 0 到 9 的数字）。
 使用两个星号`（*) `表示匹配任意中间目录，比如\`a/**/z\` 可以匹配 a/z, a/b/z 或 `a/b/c/z`等。

>要查看尚未暂存的文件更新了哪些部分，不加参数直接输入`git diff`
此命令比较的是工作目录中当前文件和暂存区域快照之间的差异， 也就是修改之后还没有暂存起来的变化内容。

>若要查看已暂存的将要添加到下次提交里的内容，可以用 `git diff --cached `命令。
（Git 1.6.1 及更高版本还允许使用 `git diff --staged`，效果是相同的，但更好记些。）

- 提交更新`git commit`
- 移除文件`git rm *`
